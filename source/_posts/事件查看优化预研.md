---
title: 事件查看优化预研
date: 2024-12-10 10:19:17
tags: 
 - FR
---

# 背景

当前规则团队新增的规则需要手动修改从 Windows 获取的事件， 非常不方便。 因此需要进行自动化。

从以下三个方面入手。

## 自动化动态调整日志的订阅

## 自动化修改事件的过滤规则

## 自动化修改系统相关配置开关和设定
- 该部分实现后默认关闭， 设定为只有管理员从 UI 下发才能修改。


# 参考 FD
- 代京 [https://rd.hillstonenet.com/doc/detail/unique-161393](FR33088-FR33089-FR33084-windows&linux数据流&用户态事件过滤机制-FD.docx)

# 定位

edr_trace 溯源

LRU filebeat/input/hillstone/lruCache

winlog 日志按照条件过滤 /beats3/uhs-log/ues/uhs-data-main.yml

bugID 436881 数据过滤 增加EDR winlog 事件的自动过滤配置。  r18546 r18629

beats3/uhs-log/ues/uhs-data-input-windows.yml
beats3/libbeat.processors/enrich_process/process_fields.go

# problem

1. 之前走不走文件下发。
2. cal.go 271-282 怀疑有 ticker 泄露。











# Notes

filebeat/input/hillstone/start_windows.go 具有 过滤字样  164